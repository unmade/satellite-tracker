"use strict";var TRACKER=TRACKER||{};TRACKER.namespace=function(R){var e,n=R.split("."),t=TRACKER;for("TRACKER"===n[0]&&(n=n.slice(1)),e=0;e<n.length;e+=1)"undefined"==typeof t[n[e]]&&(t[n[e]]={}),t=t[n[e]];return t};
TRACKER.namespace("utils"),TRACKER.utils=function(){"use strict";function e(e,r,n){var t=$.Deferred(),o=new THREE.OBJLoader;return o.load(n,function(n){e[r]=n,t.resolve()}),t}function r(e,r,n){var t=$.Deferred(),o=new THREE.TextureLoader;return o.load(n,function(n){e[r]=n,t.resolve()}),t}return{defferedOBJLoader:e,defferedTextureLoader:r}}();
TRACKER.namespace("CelestialObject"),TRACKER.CelestialObject=function(){"use strict";function e(t){var r,i,a,s,n;r={Kr:.0025,Km:.001,ESun:20,g:-.95,innerRadius:100,outerRadius:101.5,wavelength:[.55,.5,.475],scaleDepth:.25},$.extend(r,t.atmosphere),i=t.diffuse,a=t.diffuseNight,s=t.diffuseSpecular,n=e.uniforms.configureUniforms(i,a,s,r),this.atmosphere=r,this.ground=new THREE.Mesh(new THREE.SphereGeometry(r.innerRadius,50,50),new THREE.ShaderMaterial({uniforms:n,vertexShader:$("#vertexGround").text(),fragmentShader:$("#fragmentGround").text()})),this.sky=new THREE.Mesh(new THREE.SphereGeometry(r.outerRadius,500,500),new THREE.ShaderMaterial({uniforms:n,vertexShader:$("#vertexSky").text(),fragmentShader:$("#fragmentSky").text(),side:THREE.BackSide,transparent:!0}))}return e.prototype.ESun=function(t){if(!arguments.length)return this.atmosphere.ESun;var r=e.uniforms.calcfKrESun(this.atmosphere.Kr,t),i=e.uniforms.calcfKmESun(this.atmosphere.Km,t);this.atmosphere.ESun=t,this.ground.material.uniforms.fKrESun.value=r,this.ground.material.uniforms.fKmESun.value=i,this.sky.material.uniforms.fKmESun.value=i,this.sky.material.uniforms.fKrESun.value=r},e.prototype.g=function(e){if(!arguments.length)return this.atmosphere.g;var t=e*e;this.atmosphere.g=e,this.sky.material.uniforms.g.value=e,this.sky.material.uniforms.g2.value=t,this.ground.material.uniforms.g.value=e,this.ground.material.uniforms.g2.value=t},e.prototype.Km=function(t){if(!arguments.length)return this.atmosphere.Km;var r=e.uniforms.calcfKmESun(t,this.atmosphere.ESun),i=e.uniforms.calcfKm4PI(t);this.atmosphere.Km=t,this.ground.material.uniforms.fKmESun.value=r,this.ground.material.uniforms.fKm4PI.value=i,this.sky.material.uniforms.fKm4PI.value=i,this.sky.material.uniforms.fKmESun.value=r},e.prototype.Kr=function(t){if(!arguments.length)return this.atmosphere.Kr;var r=e.uniforms.calcfKrESun(t,this.atmosphere.ESun),i=e.uniforms.calcfKr4PI(t);this.atmosphere.Kr=t,this.ground.material.uniforms.fKrESun.value=r,this.ground.material.uniforms.fKr4PI.value=i,this.sky.material.uniforms.fKr4PI.value=i,this.sky.material.uniforms.fKrESun.value=r},e.prototype.lightPosition=function(e){return arguments.length?(this.ground.material.uniforms.v3LightPosition.value.copy(e).normalize(),void this.sky.material.uniforms.v3LightPosition.value.copy(e).normalize()):this.ground.material.uniforms.v3LightPosition.value},e.prototype.position=function(e){return arguments.length?(this.ground.position.copy(e),void this.sky.position.copy(e)):this.ground.position},e.prototype.setTextures=function(e){e.diffuse&&(this.ground.material.uniforms.tDiffuse.value=e.diffuse),e.diffuseNight&&(this.ground.material.uniforms.tDiffuseNight.value=e.diffuseNight),e.diffuseSpecular&&(this.ground.material.uniforms.tDiffuseSpecular.value=e.diffuseSpecular)},e.prototype.scaleDepth=function(t){if(!arguments.length)return this.atmosphere.scaleDepth;var r=e.uniforms.calcfScaleOverScaleDepth(this.atmosphere.innerRadius,this.atmosphere.outerRadius,this.atmosphere.scaleDepth);this.atmosphere.scaleDepth=t,this.ground.material.uniforms.fScaleDepth.value=t,this.ground.material.uniforms.fScaleDepth.value=t,this.sky.material.uniforms.fScaleOverScaleDepth.value=r,this.sky.material.uniforms.fScaleOverScaleDepth.value=r},e.prototype.waveBlue=function(t){if(!arguments.length)return this.atmosphere.wavelength[2];var r=e.uniforms.calcvWaveChannel(t);this.atmosphere.wavelength[2]=t,this.ground.material.uniforms.v3InvWavelength.value.setZ(r),this.sky.material.uniforms.v3InvWavelength.value.setZ(r)},e.prototype.waveGreen=function(t){if(!arguments.length)return this.atmosphere.wavelength[1];var r=e.uniforms.calcvWaveChannel(t);this.atmosphere.wavelength[1]=t,this.ground.material.uniforms.v3InvWavelength.value.setY(r),this.sky.material.uniforms.v3InvWavelength.value.setY(r)},e.prototype.waveRed=function(t){if(!arguments.length)return this.atmosphere.wavelength[0];var r=e.uniforms.calcvWaveChannel(t);this.atmosphere.wavelength[0]=t,this.ground.material.uniforms.v3InvWavelength.value.setX(r),this.sky.material.uniforms.v3InvWavelength.value.setX(r)},e}();
TRACKER.namespace("CelestialObject.uniforms"),TRACKER.CelestialObject.uniforms=function(){"use strict";function e(e,t){return e*t}function t(e,t){return e*t}function u(e){return 4*e*Math.PI}function a(e){return 4*e*Math.PI}function n(e,t,u){return 1/(t-e)/u}function f(e){return 1/Math.pow(e,4)}function l(l,r,i,c){return{v3LightPosition:{type:"v3",value:new THREE.Vector3(1e8,0,1e8).normalize()},v3InvWavelength:{type:"v3",value:new THREE.Vector3(f(c.wavelength[0]),f(c.wavelength[1]),f(c.wavelength[2]))},fCameraHeight:{type:"f",value:0},fCameraHeight2:{type:"f",value:0},fInnerRadius:{type:"f",value:c.innerRadius},fInnerRadius2:{type:"f",value:c.innerRadius*c.innerRadius},fOuterRadius:{type:"f",value:c.outerRadius},fOuterRadius2:{type:"f",value:c.outerRadius*c.outerRadius},fKrESun:{type:"f",value:e(c.Kr,c.ESun)},fKmESun:{type:"f",value:t(c.Km,c.ESun)},fKr4PI:{type:"f",value:u(c.Kr)},fKm4PI:{type:"f",value:a(c.Km)},fScale:{type:"f",value:1/(c.outerRadius-c.innerRadius)},fScaleDepth:{type:"f",value:c.scaleDepth},fScaleOverScaleDepth:{type:"f",value:n(c.innerRadius,c.outerRadius,c.scaleDepth)},g:{type:"f",value:c.g},g2:{type:"f",value:c.g*c.g},tDiffuse:{type:"t",value:l},tDiffuseNight:{type:"t",value:r},tDiffuseSpecular:{type:"t",value:i},fNightScale:{type:"f",value:1},fSpecularScale:{type:"f",value:1},fSpecularSize:{type:"f",value:25}}}return{calcfKrESun:e,calcfKmESun:t,calcfKr4PI:u,calcfKm4PI:a,calcfScaleOverScaleDepth:n,calcvWaveChannel:f,configureUniforms:l}}();
$(document).ready(function(){"use strict";function e(){var e,E={},R=1738.14/w,C=new Date,T=document.getElementById("scene");s=new THREE.PerspectiveCamera(20,g/h,1,2e5),s.up=new THREE.Vector3(0,1,0),u=new THREE.Scene;new THREE.AxisHelper(1e3);f=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),f.setPixelRatio(window.devicePixelRatio||1),f.setSize(g,h),f.setClearColor(0,1),T.appendChild(f.domElement),m=new THREE.TrackballControls(s,document.getElementById("scene")),m.minDistance=300,m.maxDistance=1e5,window.addEventListener("resize",t,!1);var H=function(){n=TRACKER.sun,o=TRACKER.milkyway,i=new TRACKER.CelestialObject({diffuse:E.earthDay,diffuseNight:E.earthNight,diffuseSpecular:E.earthSpecular}),r=new TRACKER.CelestialObject({atmosphere:{ESun:10,innerRadius:R,outerRadius:R+.1,wavelength:[.55,.55,.55]},diffuse:E.moon,diffuseNight:E.moonNight,diffuseSpecular:E.moonSpecular}),E.elektro.scale.set(.001,.001,.001),l=new TRACKER.Satellite(p.elektro1,w,E.elektro.clone()),d=new TRACKER.Satellite(p.elektro2,w,E.elektro.clone()),e=l.propagate(C),d.propagate(C),s.position.copy(e).multiplyScalar(1.05),i.lightPosition(e),r.position(new THREE.Vector3(100,4e5/w,200)),r.lightPosition(e),n.lensFlare.position.copy(e).multiplyScalar(100),n.light.position.copy(e).multiplyScalar(100),u.add(i.ground),u.add(i.sky),u.add(r.ground),u.add(r.sky),u.add(l.object3d),u.add(d.object3d),u.add(n.lensFlare),u.add(n.light),u.add(new THREE.AmbientLight(3355443)),a()};$.when(c.defferedTextureLoader(E,"earthDay","/src/images/earth/diffuse-low.jpg"),c.defferedTextureLoader(E,"earthNight","/src/images/earth/diffuse-night-low.jpg"),c.defferedTextureLoader(E,"earthSpecular","/src/images/earth/diffuse-specular-low.png"),c.defferedTextureLoader(E,"moon","/src/images/moon-low.jpg"),c.defferedTextureLoader(E,"moonNight","/src/images/earth/default-night.jpg"),c.defferedTextureLoader(E,"moonSpecular","/src/images/earth/default-specular.png"),c.defferedOBJLoader(E,"elektro","/src/obj/elektro.obj")).then(function(){H()})}function a(){m.update(),requestAnimationFrame(a);var e=s.position.length(),t=e*e;return i.sky.material.uniforms.fCameraHeight.value=e,i.sky.material.uniforms.fCameraHeight2.value=t,i.ground.material.uniforms.fCameraHeight.value=e,i.ground.material.uniforms.fCameraHeight2.value=t,r.ground.material.uniforms.fCameraHeight.value=e,r.ground.material.uniforms.fCameraHeight2.value=t,r.sky.material.uniforms.fCameraHeight.value=e,r.sky.material.uniforms.fCameraHeight2.value=t,f.render(u,s)}function t(){s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)}var i,r,n,o,l,d,s,u,f,m,c=TRACKER.utils,g=window.innerWidth,h=window.innerHeight,p={elektro1:{line1:"1 37344U 11001A   16084.50580970  .00000000  00000-0  10000-3 0  9991",line2:"2 37344   1.5394  79.7599 0005633 181.1213 179.7726  1.00271467 19002"},elektro2:{line1:"1 41105U 15074A   16084.53509896 -.00000132  00000-0  00000+0 0  9998",line2:"2 41105   0.2604 277.8149 0001219 144.5680  30.4420  1.00273958  1058"}},w=63.71;e()});
"use strict";TRACKER.namespace("milkyway"),TRACKER.milkyway=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(1e4,64,64),new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("/src/images/milkyway/milkyway.jpg"),side:THREE.BackSide,opacity:.1}));return{milkyway:e}}();
TRACKER.namespace("Satellite"),TRACKER.Satellite=function(){"use strict";var t,e=(TRACKER.utils,2*Math.PI/86164.09);return t=function(t,e,i){this.axis=new THREE.Vector3(0,1,0),this.object3d=i,this.satrec=satellite.twoline2satrec(t.line1,t.line2),this.scale=e},t.prototype.fixPosition=function(t){var e=satellite.propagate(this.satrec,t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()).position;return new THREE.Vector3(e.x,e.z,-e.y).divideScalar(this.scale)},t.prototype.setObj=function(t){this.object3d=t},t.prototype.propagate=function(t,e){var i=this.terraPosition(t,e);return this.object3d.position.copy(i),i},t.prototype.terraPosition=function(t,i){var o,s=i||satellite.gstimeFromDate(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds());return o=s*(180/Math.PI),o+=o>=360?-360:0>o?360:0,this.fixPosition(t).applyAxisAngle(this.axis,-e*o/15*3600)},t}();
"use strict";TRACKER.namespace("sun"),TRACKER.sun=function(){function e(e,a,r,o,E,c){s=new THREE.DirectionalLight(16777215,1),s.position.set(o,E,c);var g=new THREE.Color(16777215);g.setHSL(e,a,r+.5),i=new THREE.LensFlare(l,350,0,THREE.AdditiveBlending,g),i.add(d,512,0,THREE.AdditiveBlending),i.add(t,60,.6,THREE.AdditiveBlending),i.add(t,70,.7,THREE.AdditiveBlending),i.add(t,120,.9,THREE.AdditiveBlending),i.add(t,70,1,THREE.AdditiveBlending),i.customUpdateCallback=n,i.position.set(o,E,c)}function n(e){var n,i,s=e.lensFlares.length,a=2*-e.positionScreen.x,l=2*-e.positionScreen.y;for(n=0;s>n;n++)i=e.lensFlares[n],i.x=e.positionScreen.x+a*i.distance,i.y=e.positionScreen.y+l*i.distance,i.rotation=0;e.lensFlares[2].y+=.025,e.lensFlares[3].rotation=.5*e.positionScreen.x+THREE.Math.degToRad(45)}var i,s,a=new THREE.TextureLoader,l=a.load("/src/images/lensflare/lensflare0.png"),d=a.load("/src/images/lensflare/lensflare2.png"),t=a.load("/src/images/lensflare/lensflare3.png");return e(.55,.9,.5,5e3,0,5e3),{light:s,lensFlare:i}}();
//# sourceMappingURL=elektro-tracker.min.js.map
