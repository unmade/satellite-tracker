"use strict";var TRACKER=TRACKER||{};TRACKER.namespace=function(R){var e,n=R.split("."),t=TRACKER;for("TRACKER"===n[0]&&(n=n.slice(1)),e=0;e<n.length;e+=1)"undefined"==typeof t[n[e]]&&(t[n[e]]={}),t=t[n[e]];return t};
TRACKER.namespace("utils.Constants"),TRACKER.utils.Constants=function(){"use strict";return{AU:149597870.691,DIFF_EPOCH:2400000.5,GRAD_IN_RAD:.017453292519943295,JULIAN_C:36525,MJD2000:51544.5,OMEGA:2*Math.PI/86164.090530833,PI2:2*Math.PI,SEC_IN_DAY:86400,SEC_IN_RAD:484813681109536e-20,TT_TAI_DIFF:32.184}}();
TRACKER.namespace("utils.CoordinateConverter"),TRACKER.utils.CoordinateConverter=function(){"use strict";function t(t,e,n,r){var s=a(t);return new THREE.Vector3(r*Math.cos(n)*Math.cos(e),r*Math.cos(n)*(Math.cos(s)*Math.sin(e)-Math.sin(s)*Math.tan(n)),r*Math.cos(n)*(Math.sin(s)*Math.sin(e)+Math.cos(s)*Math.tan(n)))}function e(t,e,n,r){var s=a(t);return new THREE.Vector3(e,n*Math.cos(s)-r*Math.sin(s),n*Math.sin(s)+r*Math.cos(s))}function a(t){var e=(t-s.MJD2000)/s.JULIAN_C,a=e*e,n=e*a;return s.SEC_IN_RAD*(84381.448-46.815*e-59e-5*a+.001813*n)}function n(t,e){var a,n=e||satellite.gstimeFromDate(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds());return a=n/s.GRAD_IN_RAD,a+=a>=360?-360:0>a?360:0,-s.OMEGA*a/15*3600}function r(t,e,a){return new THREE.Vector3(a*Math.cos(e)*Math.cos(t),a*Math.cos(e)*Math.sin(t),a*Math.sin(e))}var s=TRACKER.utils.Constants;return{eclipSpherToEquCart:t,eclipticToEquatorial:e,getTerrestrialAngle:n,getEpsMean:a,sphericalToCartesian:r}}();
TRACKER.namespace("utils.DateConverter"),TRACKER.utils.DateConverter=function(){"use strict";function e(e){var a=e.getUTCFullYear(),s=e.getUTCMonth()+1,r=e.getUTCDate(),t=e.getUTCHours(),b=e.getUTCMinutes(),k=e.getUTCSeconds(),n=parseInt((14-s)/12),u=a+4800-n,T=s+12*n-3,C=r+parseInt((153*T+2)/5)+365*u+parseInt(u/4)-parseInt(u/100)+parseInt(u/400)-32045,o=C+(t-12)/24+b/1440+k/86400;return o-c.DIFF_EPOCH}function a(e){var a=s(e),r=(a-c.MJD2000)/c.JULIAN_C,t=c.GRAD_IN_RAD*(12860948.6049*r);return a+.001658*Math.sin(t+.0167*Math.sin(t))/c.SEC_IN_DAY}function s(a){var s=e(a),t=r(a.getUTCFullYear(),a.getUTCMonth()+1);return s+t/c.SEC_IN_DAY}function r(e,a){var s=0;switch(e){case 1972:s=a>0&&7>a?10:11;break;case 1973:s=12;break;case 1974:s=13;break;case 1975:s=14;break;case 1976:s=15;break;case 1977:s=16;break;case 1978:s=17;break;case 1979:s=18;break;case 1980:s=19;break;case 1981:s=a>0&&7>a?19:20;break;case 1982:s=a>0&&7>a?20:21;break;case 1983:s=a>0&&7>a?21:22;break;case 1984:s=22;break;case 1985:s=a>0&&7>a?22:23;break;case 1986:case 1987:s=23;break;case 1988:case 1989:s=24;break;case 1990:s=25;break;case 1991:s=26;break;case 1992:s=a>0&&7>a?26:27;break;case 1993:s=a>0&&7>a?27:28;break;case 1994:s=a>0&&7>a?28:29;break;case 1995:s=29;break;case 1996:s=30;break;case 1997:s=a>0&&7>a?30:31;break;case 1998:s=31;break;case 1999:case 2e3:case 2001:case 2002:case 2003:case 2004:case 2005:s=32;break;case 2006:case 2007:case 2008:s=33;break;case 2009:case 2010:case 2011:s=34;break;case 2012:s=a>0&&7>a?34:35;break;case 2013:case 2014:s=35;break;case 2015:s=a>0&&7>a?35:36;break;default:s=e>1972?36:10}return s+c.TT_TAI_DIFF}var c=TRACKER.utils.Constants;return{getDeltaT:r,utcToMjd:e,utcToTdb:a,utcToTT:s}}();
TRACKER.namespace("utils.Loaders"),TRACKER.utils.Loaders=function(){"use strict";function e(e,r,n){var o=$.Deferred(),d=new THREE.OBJLoader;return d.load(n,function(n){e[r]=n,o.resolve()}),o}function r(e,r,n){var o=$.Deferred(),d=new THREE.TextureLoader;return d.load(n,function(n){e[r]=n,o.resolve()}),o}return{defferedOBJLoader:e,defferedTextureLoader:r}}();
TRACKER.namespace("CelestialObject"),TRACKER.CelestialObject=function(){"use strict";function e(t){var r,i,a,s,n;r={Kr:.0025,Km:.001,ESun:20,g:-.95,innerRadius:100,outerRadius:101.5,wavelength:[.55,.5,.475],scaleDepth:.25},$.extend(r,t.atmosphere),i=t.diffuse,a=t.diffuseNight,s=t.diffuseSpecular,n=e.uniforms.configureUniforms(i,a,s,r),this.atmosphere=r,this.ground=new THREE.Mesh(new THREE.SphereGeometry(r.innerRadius,50,50),new THREE.ShaderMaterial({uniforms:n,vertexShader:$("#vertexGround").text(),fragmentShader:$("#fragmentGround").text()})),this.sky=new THREE.Mesh(new THREE.SphereGeometry(r.outerRadius,500,500),new THREE.ShaderMaterial({uniforms:n,vertexShader:$("#vertexSky").text(),fragmentShader:$("#fragmentSky").text(),side:THREE.BackSide,transparent:!0}))}return e.prototype.ESun=function(t){if(!arguments.length)return this.atmosphere.ESun;var r=e.uniforms.calcfKrESun(this.atmosphere.Kr,t),i=e.uniforms.calcfKmESun(this.atmosphere.Km,t);this.atmosphere.ESun=t,this.ground.material.uniforms.fKrESun.value=r,this.ground.material.uniforms.fKmESun.value=i,this.sky.material.uniforms.fKmESun.value=i,this.sky.material.uniforms.fKrESun.value=r},e.prototype.g=function(e){if(!arguments.length)return this.atmosphere.g;var t=e*e;this.atmosphere.g=e,this.sky.material.uniforms.g.value=e,this.sky.material.uniforms.g2.value=t,this.ground.material.uniforms.g.value=e,this.ground.material.uniforms.g2.value=t},e.prototype.Km=function(t){if(!arguments.length)return this.atmosphere.Km;var r=e.uniforms.calcfKmESun(t,this.atmosphere.ESun),i=e.uniforms.calcfKm4PI(t);this.atmosphere.Km=t,this.ground.material.uniforms.fKmESun.value=r,this.ground.material.uniforms.fKm4PI.value=i,this.sky.material.uniforms.fKm4PI.value=i,this.sky.material.uniforms.fKmESun.value=r},e.prototype.Kr=function(t){if(!arguments.length)return this.atmosphere.Kr;var r=e.uniforms.calcfKrESun(t,this.atmosphere.ESun),i=e.uniforms.calcfKr4PI(t);this.atmosphere.Kr=t,this.ground.material.uniforms.fKrESun.value=r,this.ground.material.uniforms.fKr4PI.value=i,this.sky.material.uniforms.fKr4PI.value=i,this.sky.material.uniforms.fKrESun.value=r},e.prototype.lightPosition=function(e){return arguments.length?(this.ground.material.uniforms.v3LightPosition.value.copy(e).normalize(),void this.sky.material.uniforms.v3LightPosition.value.copy(e).normalize()):this.ground.material.uniforms.v3LightPosition.value},e.prototype.position=function(e){return arguments.length?(this.ground.position.copy(e),void this.sky.position.copy(e)):this.ground.position},e.prototype.setTextures=function(e){e.diffuse&&(this.ground.material.uniforms.tDiffuse.value=e.diffuse),e.diffuseNight&&(this.ground.material.uniforms.tDiffuseNight.value=e.diffuseNight),e.diffuseSpecular&&(this.ground.material.uniforms.tDiffuseSpecular.value=e.diffuseSpecular)},e.prototype.scaleDepth=function(t){if(!arguments.length)return this.atmosphere.scaleDepth;var r=e.uniforms.calcfScaleOverScaleDepth(this.atmosphere.innerRadius,this.atmosphere.outerRadius,this.atmosphere.scaleDepth);this.atmosphere.scaleDepth=t,this.ground.material.uniforms.fScaleDepth.value=t,this.ground.material.uniforms.fScaleDepth.value=t,this.sky.material.uniforms.fScaleOverScaleDepth.value=r,this.sky.material.uniforms.fScaleOverScaleDepth.value=r},e.prototype.waveBlue=function(t){if(!arguments.length)return this.atmosphere.wavelength[2];var r=e.uniforms.calcvWaveChannel(t);this.atmosphere.wavelength[2]=t,this.ground.material.uniforms.v3InvWavelength.value.setZ(r),this.sky.material.uniforms.v3InvWavelength.value.setZ(r)},e.prototype.waveGreen=function(t){if(!arguments.length)return this.atmosphere.wavelength[1];var r=e.uniforms.calcvWaveChannel(t);this.atmosphere.wavelength[1]=t,this.ground.material.uniforms.v3InvWavelength.value.setY(r),this.sky.material.uniforms.v3InvWavelength.value.setY(r)},e.prototype.waveRed=function(t){if(!arguments.length)return this.atmosphere.wavelength[0];var r=e.uniforms.calcvWaveChannel(t);this.atmosphere.wavelength[0]=t,this.ground.material.uniforms.v3InvWavelength.value.setX(r),this.sky.material.uniforms.v3InvWavelength.value.setX(r)},e}();
TRACKER.namespace("CelestialObject.uniforms"),TRACKER.CelestialObject.uniforms=function(){"use strict";function e(e,t){return e*t}function t(e,t){return e*t}function u(e){return 4*e*Math.PI}function a(e){return 4*e*Math.PI}function n(e,t,u){return 1/(t-e)/u}function f(e){return 1/Math.pow(e,4)}function l(l,r,i,c){return{v3LightPosition:{type:"v3",value:new THREE.Vector3(1e8,0,1e8).normalize()},v3InvWavelength:{type:"v3",value:new THREE.Vector3(f(c.wavelength[0]),f(c.wavelength[1]),f(c.wavelength[2]))},fCameraHeight:{type:"f",value:0},fCameraHeight2:{type:"f",value:0},fInnerRadius:{type:"f",value:c.innerRadius},fInnerRadius2:{type:"f",value:c.innerRadius*c.innerRadius},fOuterRadius:{type:"f",value:c.outerRadius},fOuterRadius2:{type:"f",value:c.outerRadius*c.outerRadius},fKrESun:{type:"f",value:e(c.Kr,c.ESun)},fKmESun:{type:"f",value:t(c.Km,c.ESun)},fKr4PI:{type:"f",value:u(c.Kr)},fKm4PI:{type:"f",value:a(c.Km)},fScale:{type:"f",value:1/(c.outerRadius-c.innerRadius)},fScaleDepth:{type:"f",value:c.scaleDepth},fScaleOverScaleDepth:{type:"f",value:n(c.innerRadius,c.outerRadius,c.scaleDepth)},g:{type:"f",value:c.g},g2:{type:"f",value:c.g*c.g},tDiffuse:{type:"t",value:l},tDiffuseNight:{type:"t",value:r},tDiffuseSpecular:{type:"t",value:i},fNightScale:{type:"f",value:1},fSpecularScale:{type:"f",value:1},fSpecularSize:{type:"f",value:25}}}return{calcfKrESun:e,calcfKmESun:t,calcfKr4PI:u,calcfKm4PI:a,calcfScaleOverScaleDepth:n,calcvWaveChannel:f,configureUniforms:l}}();
$(document).ready(function(){"use strict";function e(){var e,r={},T=1738.14/E,C=document.getElementById("scene");f=new THREE.PerspectiveCamera(20,h/p,1,1e10),f.up=new THREE.Vector3(0,1,0),u=new THREE.Scene;new THREE.AxisHelper(1e3);m=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),m.setPixelRatio(window.devicePixelRatio||1),m.setSize(h,p),m.setClearColor(0,1),C.appendChild(m.domElement),g=new THREE.TrackballControls(f,document.getElementById("scene")),g.minDistance=300,g.maxDistance=1e10,window.addEventListener("resize",n,!1);var H=function(){l=new TRACKER.Sun([r.lensflare0,r.lensflare2,r.lensflare3]),o=TRACKER.milkyway,t=new TRACKER.CelestialObject({diffuse:r.earthDay,diffuseNight:r.earthNight,diffuseSpecular:r.earthSpecular}),i=new TRACKER.CelestialObject({atmosphere:{ESun:10,innerRadius:T,outerRadius:T+.1,wavelength:[.55,.55,.55]},diffuse:r.moon,diffuseNight:r.moonNight,diffuseSpecular:r.moonSpecular}),r.elektro.scale.set(.001,.001,.001),d=new TRACKER.Satellite(w.elektro1,E,r.elektro.clone()),s=new TRACKER.Satellite(w.elektro2,E,r.elektro.clone()),e=d.propagate(R),s.propagate(R),f.position.copy(e).multiplyScalar(1.05);var n=l.propagate(R);t.lightPosition(n),i.position(new THREE.Vector3(100,4e5/E,200)),i.lightPosition(n),u.add(t.ground),u.add(t.sky),u.add(i.ground),u.add(i.sky),u.add(d.object3d),u.add(s.object3d),u.add(l.lensFlare),u.add(l.light),u.add(new THREE.AmbientLight(1118481)),a()};$.when(c.defferedTextureLoader(r,"earthDay","/src/images/earth/diffuse-low.jpg"),c.defferedTextureLoader(r,"earthNight","/src/images/earth/diffuse-night-low.jpg"),c.defferedTextureLoader(r,"earthSpecular","/src/images/earth/diffuse-specular-low.png"),c.defferedTextureLoader(r,"lensflare0","/src/images/lensflare/lensflare0.png"),c.defferedTextureLoader(r,"lensflare2","/src/images/lensflare/lensflare2.png"),c.defferedTextureLoader(r,"lensflare3","/src/images/lensflare/lensflare3.png"),c.defferedTextureLoader(r,"moon","/src/images/moon/moon-low.jpg"),c.defferedTextureLoader(r,"moonNight","/src/images/earth/default-night.jpg"),c.defferedTextureLoader(r,"moonSpecular","/src/images/earth/default-specular.png"),c.defferedOBJLoader(r,"elektro","/src/obj/elektro.obj")).then(function(){H()})}function a(){requestAnimationFrame(a),r()}function r(){g.update();var e=f.position.length(),a=e*e;return t.sky.material.uniforms.fCameraHeight.value=e,t.sky.material.uniforms.fCameraHeight2.value=a,t.ground.material.uniforms.fCameraHeight.value=e,t.ground.material.uniforms.fCameraHeight2.value=a,i.ground.material.uniforms.fCameraHeight.value=e,i.ground.material.uniforms.fCameraHeight2.value=a,i.sky.material.uniforms.fCameraHeight.value=e,i.sky.material.uniforms.fCameraHeight2.value=a,m.render(u,f)}function n(){f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),m.setSize(window.innerWidth,window.innerHeight)}var t,i,l,o,d,s,f,u,m,g,c=TRACKER.utils.Loaders,h=window.innerWidth,p=window.innerHeight,w={elektro1:{line1:"1 37344U 11001A   16084.50580970  .00000000  00000-0  10000-3 0  9991",line2:"2 37344   1.5394  79.7599 0005633 181.1213 179.7726  1.00271467 19002"},elektro2:{line1:"1 41105U 15074A   16084.53509896 -.00000132  00000-0  00000+0 0  9998",line2:"2 41105   0.2604 277.8149 0001219 144.5680  30.4420  1.00273958  1058"},iss:{line1:"1 25544U 98067A   16087.52161653  .00004158  00000-0  69668-4 0  9998",line2:"2 25544  51.6430 105.3354 0002084   2.4544 144.7923 15.54266717992278"}},E=63.71,R=new Date;e()});
"use strict";TRACKER.namespace("milkyway"),TRACKER.milkyway=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(1e4,64,64),new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("/src/images/milkyway/milkyway.jpg"),side:THREE.BackSide,opacity:.1}));return{milkyway:e}}();
TRACKER.namespace("Satellite"),TRACKER.Satellite=function(){"use strict";var t,e=(TRACKER.utils.Constants,TRACKER.utils.CoordinateConverter);return t=function(t,e,i){this.axis=new THREE.Vector3(0,1,0),this.object3d=i,this.satrec=satellite.twoline2satrec(t.line1,t.line2),this.scale=e},t.prototype.setObj=function(t){this.object3d=t},t.prototype.position=function(t,i){var s=satellite.propagate(this.satrec,t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()).position;return new THREE.Vector3(s.x,s.z,-s.y).divideScalar(this.scale).applyAxisAngle(this.axis,e.getTerrestrialAngle(t,i))},t.prototype.propagate=function(t,e){var i=this.position(t,e);return this.object3d.position.copy(i),i},t}();
TRACKER.namespace("Sun"),TRACKER.Sun=function(){"use strict";function e(e){return e%1}function t(e){var t,n,i=e.lensFlares.length,s=2*-e.positionScreen.x,o=2*-e.positionScreen.y;for(t=0;i>t;t++)n=e.lensFlares[t],n.x=e.positionScreen.x+s*n.distance,n.y=e.positionScreen.y+o*n.distance,n.rotation=0;e.lensFlares[2].y+=.025,e.lensFlares[3].rotation=.5*e.positionScreen.x+THREE.Math.degToRad(45)}var n=TRACKER.utils.Constants,i=TRACKER.utils.CoordinateConverter,s=TRACKER.utils.DateConverter,o=function(e,n){var i=new THREE.Color(16777215);n?i.setHSL(n.h,n.s,n.l+.5):i.setHSL(.55,.9,1),this.light=new THREE.DirectionalLight(16777215,1),this.lensFlare=new THREE.LensFlare(e[0],350,0,THREE.AdditiveBlending,i),this.lensFlare.add(e[1],512,0,THREE.AdditiveBlending),this.lensFlare.add(e[2],60,.6,THREE.AdditiveBlending),this.lensFlare.add(e[2],70,.7,THREE.AdditiveBlending),this.lensFlare.add(e[2],120,.9,THREE.AdditiveBlending),this.lensFlare.add(e[2],70,1,THREE.AdditiveBlending),this.lensFlare.customUpdateCallback=t};return o.prototype.sunEclipticPosition=function(t){var i=s.utcToTdb(t),o=(i-n.MJD2000)/n.JULIAN_C,a=n.PI2*e(.993133+99.997361*o),r=n.PI2*e(.7859453+a/n.PI2+(6893*Math.sin(a)+72*Math.sin(2*a)+6191.2*o)/1296e3),l=0,d=1.0001398+1e-6*((-16707.37+42.04*o)*Math.cos(a)-139.57*Math.cos(2*a)+30.76*Math.cos(n.PI2*e(.8274+1236.8531*o)));return{lambda:r,betta:l,range:d*n.AU}},o.prototype.position=function(e){var t=s.utcToTdb(e),n=this.sunEclipticPosition(e),o=i.eclipSpherToEquCart(t,n.lambda,n.betta,n.range);return new THREE.Vector3(o.x,o.z,-o.y).divideScalar(63.71).applyAxisAngle(new THREE.Vector3(0,1,0),i.getTerrestrialAngle(e))},o.prototype.propagate=function(e){var t=this.position(e);return this.lensFlare.position.copy(t),this.light.position.copy(t),t},o}();
//# sourceMappingURL=elektro-tracker.min.js.map
