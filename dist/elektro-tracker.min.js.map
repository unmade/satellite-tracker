{"version":3,"sources":["module.js","utils.constants.js","utils.coordinate-converter.js","utils.date-converter.js","utils.loaders.js","celestial-object.js","celestial-object.uniforms.js","main.js","milkyway.js","satellite.js","sun.js"],"names":["TRACKER","namespace","ns","i","parts","split","parent","slice","length","utils","Constants","AU","DIFF_EPOCH","GRAD_IN_RAD","JULIAN_C","MJD2000","OMEGA","Math","PI","PI2","SEC_IN_DAY","SEC_IN_RAD","TT_TAI_DIFF","CoordinateConverter","eclipSpherToEquCart","tdb","l","b","r","eps","getEpsMean","THREE","Vector3","cos","sin","tan","eclipticToEquatorial","x","y","z","ts","Const","ts2","ts3","getTerrestrialAngle","date","gmst","deg","_gmst","satellite","gstimeFromDate","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","sphericalToCartesian","DateConverter","utcToMjd","nyear","nmonth","nday","nhours","nminutes","nseconds","a","parseInt","m","jdn","jd","utcToTdb","tt","utcToTT","d","g","mjd","deltaT","getDeltaT","leap_second","Loaders","defferedOBJLoader","obj","name","url","defer","$","Deferred","loader","OBJLoader","load","event","resolve","defferedTextureLoader","TextureLoader","CelestialObject","userConf","atmosphere","diffuse","diffuseNight","diffuseSpecular","uniforms","Kr","Km","ESun","innerRadius","outerRadius","wavelength","scaleDepth","extend","configureUniforms","this","ground","Mesh","SphereGeometry","ShaderMaterial","vertexShader","text","fragmentShader","sky","side","BackSide","transparent","prototype","val","arguments","fKrESun","calcfKrESun","fKmESun","calcfKmESun","material","value","val2","g2","fKm4PI","calcfKm4PI","fKr4PI","calcfKr4PI","lightPosition","position","v3LightPosition","copy","normalize","setTextures","textures","tDiffuse","tDiffuseNight","tDiffuseSpecular","overScale","calcfScaleOverScaleDepth","fScaleDepth","fScaleOverScaleDepth","waveBlue","blue","calcvWaveChannel","v3InvWavelength","setZ","waveGreen","green","setY","waveRed","red","setX","pow","type","fCameraHeight","fCameraHeight2","fInnerRadius","fInnerRadius2","fOuterRadius","fOuterRadius2","fScale","fNightScale","fSpecularScale","fSpecularSize","document","ready","init","assets","moonRadius","scale","webglEl","getElementById","camera","PerspectiveCamera","width","height","up","scene","Scene","AxisHelper","renderer","WebGLRenderer","antialias","alpha","setPixelRatio","window","devicePixelRatio","setSize","setClearColor","appendChild","domElement","controls","TrackballControls","minDistance","maxDistance","addEventListener","onWindowResize","onLoad","sun","Sun","lensflare0","lensflare2","lensflare3","milkyway","earth","earthDay","earthNight","earthSpecular","moon","moonNight","moonSpecular","elektro","set","elektro1","Satellite","tle","clone","elektro2","propagate","now","multiplyScalar","add","object3d","lensFlare","light","AmbientLight","animate","when","loaders","then","requestAnimationFrame","render","update","cameraHeight","cameraHeight2","aspect","innerWidth","innerHeight","updateProjectionMatrix","line1","line2","iss","Date","MeshBasicMaterial","map","ImageUtils","loadTexture","opacity","CoordConverter","axis","satrec","twoline2satrec","setObj","p","divideScalar","applyAxisAngle","frac","f","lensFlareUpdateCallback","object","flare","fl","lensFlares","vecX","positionScreen","vecY","distance","rotation","degToRad","color","flareColor","Color","setHSL","h","s","DirectionalLight","LensFlare","AdditiveBlending","customUpdateCallback","sunEclipticPosition","u3","lambda","betta","range","eclPos","equPos"],"mappings":"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","file":"elektro-tracker.min.js","sourcesContent":["'use strict';\n\n\nvar TRACKER = TRACKER || {};\n\nTRACKER.namespace = function(ns) {\n    var parts = ns.split('.'),\n        parent = TRACKER,\n        i;\n    if (parts[0] === \"TRACKER\") {\n        parts = parts.slice(1);\n    }\n    for (i = 0; i < parts.length; i += 1) {\n       if (typeof parent[parts[i]] === \"undefined\") {\n           parent[parts[i]] = {};\n       }\n       parent = parent[parts[i]];\n   }\n   return parent;\n};\n","TRACKER.namespace('utils.Constants');\n\nTRACKER.utils.Constants = (function() {\n    'use strict';\n\n    // TODO: поправить названия у GRAD_IN_RAD, SEC_IN_RAD\n    return {\n        AU: 149597870.691,\n        DIFF_EPOCH: 2400000.5,\n        GRAD_IN_RAD: 0.017453292519943295088124656649908317,\n        JULIAN_C: 36525.0,\n        MJD2000: 51544.5,\n        OMEGA: 2*Math.PI / 86164.090530833,\n        PI2: 2*Math.PI,\n        SEC_IN_DAY: 86400.0,\n        SEC_IN_RAD: 4.8481368110953597467454098131995829e-06,\n        TT_TAI_DIFF: 32.184\n    }\n})();\n","TRACKER.namespace(\"utils.CoordinateConverter\");\n\nTRACKER.utils.CoordinateConverter = (function() {\n    'use strict';\n\n    var Const = TRACKER.utils.Constants;\n\n    return {\n        eclipSpherToEquCart: eclipSpherToEquCart,\n        eclipticToEquatorial: eclipticToEquatorial,\n        getTerrestrialAngle: getTerrestrialAngle,\n        getEpsMean: getEpsMean,\n        sphericalToCartesian: sphericalToCartesian\n    }\n\n    function eclipSpherToEquCart(tdb, l, b, r) {\n        var eps = getEpsMean(tdb);\n\n        return new THREE.Vector3(\n            r * Math.cos(b) * Math.cos(l),\n            r * Math.cos(b) * (Math.cos(eps)*Math.sin(l) - Math.sin(eps)*Math.tan(b)),\n            r * Math.cos(b) * (Math.sin(eps)*Math.sin(l) + Math.cos(eps)*Math.tan(b))\n        )\n    }\n\n    function eclipticToEquatorial(tdb, x, y, z) {\n        var eps = getEpsMean(tdb);\n\n        return new THREE.Vector3(\n            x,\n            y*Math.cos(eps) - z*Math.sin(eps),\n            y*Math.sin(eps) + z*Math.cos(eps)\n        );\n    }\n\n    function getEpsMean(tdb) {\n        var ts = (tdb - Const.MJD2000) / Const.JULIAN_C,\n            ts2 = ts*ts,\n            ts3 = ts*ts2;\n\n        return Const.SEC_IN_RAD * (84381.448 - 46.8150*ts - 0.00059*ts2 + 0.001813*ts3);\n    }\n\n    function getTerrestrialAngle(date, gmst) {\n        var deg,\n            _gmst = gmst || satellite.gstimeFromDate(\n                date.getUTCFullYear(),\n                date.getUTCMonth() + 1, // Note, this function requires months in range 1-12.\n                date.getUTCDate(),\n                date.getUTCHours(),\n                date.getUTCMinutes(),\n                date.getUTCSeconds()\n            );\n\n        deg = _gmst / Const.GRAD_IN_RAD;\n        deg += (deg >= 360) ? -360 : (deg < 0) ? 360 : 0;\n\n        return -Const.OMEGA * deg/15 * 3600;\n    }\n\n    function sphericalToCartesian(l, b, r) {\n        return new THREE.Vector3(\n            r * Math.cos(b) * Math.cos(l),  // x\n            r * Math.cos(b) * Math.sin(l),  // y\n            r * Math.sin(b)                 // z\n        );\n    }\n\n})();\n","TRACKER.namespace('utils.DateConverter');\n\nTRACKER.utils.DateConverter = (function() {\n    'use strict';\n    var Const = TRACKER.utils.Constants;\n\n    return {\n        getDeltaT: getDeltaT,\n        utcToMjd: utcToMjd,\n        utcToTdb: utcToTdb,\n        utcToTT: utcToTT,\n    }\n\n    function utcToMjd(date) {\n        var nyear = date.getUTCFullYear(),\n            nmonth = date.getUTCMonth() + 1,\n            nday = date.getUTCDate(),\n            nhours = date.getUTCHours(),\n            nminutes = date.getUTCMinutes(),\n            nseconds = date.getUTCSeconds();\n\n        var a = parseInt((14 - nmonth) / 12);\n        var y = nyear + 4800 - a;\n        var m = nmonth + 12*a - 3;\n\n        var jdn = nday + parseInt((153*m + 2)/5) + 365*y + parseInt(y/4) - parseInt(y/100) + parseInt(y/400) - 32045;\n\n        var jd = (jdn) + ((nhours-12.0)/24.0) + (nminutes/1440.0) + (nseconds/86400.0);\n\n        return jd - Const.DIFF_EPOCH;\n    }\n    \n    function utcToTdb(date) {\n        var tt = utcToTT(date),\n            d = (tt - Const.MJD2000) / Const.JULIAN_C,\n            g = (Const.GRAD_IN_RAD) * (357.258 * 35999.05 * d);\n\n        return tt + (0.001658 * Math.sin(g + 0.0167*Math.sin(g))) / Const.SEC_IN_DAY;\n    }\n\n    function utcToTT(date) {\n        var mjd = utcToMjd(date),\n            deltaT = getDeltaT(date.getUTCFullYear(), date.getUTCMonth() + 1);\n\n        return mjd + (deltaT / Const.SEC_IN_DAY);\n    }\n\n    function getDeltaT(nyear, nmonth) {\n        var leap_second = 0;\n\n        switch (nyear)\n        {\n            case 1972:\n                leap_second = (0 < nmonth && nmonth < 7) ? 10 : 11;\n                break;\n            case 1973:\n                leap_second = 12;\n                break;\n            case 1974:\n                leap_second = 13;\n                break;\n            case 1975:\n                leap_second = 14;\n                break;\n            case 1976:\n                leap_second = 15;\n                break;\n            case 1977:\n                leap_second = 16;\n                break;\n            case 1978:\n                leap_second = 17;\n                break;\n            case 1979:\n                leap_second = 18;\n                break;\n            case 1980:\n                leap_second = 19;\n                break;\n            case 1981:\n                leap_second = (0 < nmonth && nmonth < 7) ? 19 : 20;\n                break;\n            case 1982:\n                leap_second = (0 < nmonth && nmonth < 7) ? 20 : 21;\n                break;\n            case 1983:\n                leap_second = (0 < nmonth && nmonth < 7) ? 21 : 22;\n                break;\n            case 1984:\n                leap_second = 22;\n                break;\n            case 1985:\n                leap_second = (0 < nmonth && nmonth < 7) ? 22 : 23;\n                break;\n            case 1986:\n            case 1987:\n                leap_second = 23;\n                break;\n            case 1988:\n            case 1989:\n                leap_second = 24;\n                break;\n            case 1990:\n                leap_second = 25;\n                break;\n            case 1991:\n                leap_second = 26;\n                break;\n            case 1992:\n                leap_second = (0 < nmonth && nmonth < 7) ? 26 : 27;\n                break;\n            case 1993:\n                leap_second = (0 < nmonth && nmonth < 7) ? 27 : 28;\n                break;\n            case 1994:\n                leap_second = (0 < nmonth && nmonth < 7) ? 28 : 29;\n                break;\n            case 1995:\n                leap_second = 29;\n                break;\n            case 1996:\n                leap_second = 30;\n                break;\n            case 1997:\n                leap_second = (0 < nmonth && nmonth < 7) ? 30 : 31;\n                break;\n            case 1998:\n                leap_second = 31;\n                break;\n            case 1999:\n            case 2000:\n            case 2001:\n            case 2002:\n            case 2003:\n            case 2004:\n            case 2005:\n                leap_second = 32;\n                break;\n            case 2006:\n            case 2007:\n            case 2008:\n                leap_second = 33;\n                break;\n            case 2009:\n            case 2010:\n            case 2011:\n                leap_second = 34;\n                break;\n            case 2012:\n                leap_second = (0 < nmonth && nmonth < 7) ? 34 : 35;\n                break;\n            case 2013:\n            case 2014:\n                leap_second = 35;\n                break;\n            case 2015:\n                leap_second = (0 < nmonth && nmonth < 7) ? 35 : 36;\n                break;\n            default:\n                leap_second = (nyear > 1972) ? 36 : 10;\n        }\n\n        return leap_second + Const.TT_TAI_DIFF;\n    }\n\n})();\n","TRACKER.namespace('utils.Loaders');\n\nTRACKER.utils.Loaders = (function() {\n    'use strict';\n\n    return {\n        defferedOBJLoader: defferedOBJLoader,\n        defferedTextureLoader: defferedTextureLoader\n    }\n\n\n    function defferedOBJLoader(obj, name, url)\n    {\n        var defer = $.Deferred();\n        var loader = new THREE.OBJLoader();\n        loader.load(url, function ( event ) {\n            obj[name] = event;\n            defer.resolve();\n        });\n\n        return defer;\n    }\n\n\n    function defferedTextureLoader(obj, name, url)\n    {\n        var defer = $.Deferred();\n        var loader = new THREE.TextureLoader();\n        loader.load(url, function ( event ) {\n            obj[name] = event;\n            defer.resolve();\n        });\n\n        return defer;\n    }\n\n})();\n","TRACKER.namespace('CelestialObject');\n\nTRACKER.CelestialObject = (function() {\n    'use strict';\n\n    function CelestialObject(userConf) {\n        var atmosphere,\n            diffuse,\n            diffuseNight,\n            diffuseSpecular,\n            uniforms;\n\n        atmosphere = {\n            Kr: 0.0025,\n            Km: 0.0010,\n            ESun: 20.0,\n            g: -0.950,\n            innerRadius: 100.0,\n            outerRadius: 101.5,\n            wavelength: [0.550, 0.50, 0.475],\n            scaleDepth: 0.25,\n        };\n        $.extend(atmosphere, userConf.atmosphere);\n\n        diffuse = userConf.diffuse;\n        diffuseNight = userConf.diffuseNight;\n        diffuseSpecular = userConf.diffuseSpecular;\n        uniforms = CelestialObject.uniforms.configureUniforms(diffuse, diffuseNight, diffuseSpecular, atmosphere);\n\n        this.atmosphere = atmosphere;\n        this.ground = new THREE.Mesh(\n            new THREE.SphereGeometry(atmosphere.innerRadius, 50, 50),\n            new THREE.ShaderMaterial({\n                uniforms: uniforms,\n                vertexShader: $(\"#vertexGround\").text(),\n                fragmentShader: $(\"#fragmentGround\").text()\n            })\n        );\n        this.sky = new THREE.Mesh(\n            new THREE.SphereGeometry(atmosphere.outerRadius, 500, 500),\n            new THREE.ShaderMaterial({\n                uniforms: uniforms,\n                vertexShader: $(\"#vertexSky\").text(),\n                fragmentShader: $(\"#fragmentSky\").text(),\n                side: THREE.BackSide,\n                transparent: true\n            })\n        );\n    };\n\n    CelestialObject.prototype.ESun = function(val) {\n        if (!arguments.length) return this.atmosphere.ESun;\n\n        var fKrESun = CelestialObject.uniforms.calcfKrESun(this.atmosphere.Kr, val),\n            fKmESun = CelestialObject.uniforms.calcfKmESun(this.atmosphere.Km, val);\n\n        this.atmosphere.ESun = val;\n        this.ground.material.uniforms.fKrESun.value = fKrESun;\n        this.ground.material.uniforms.fKmESun.value = fKmESun;\n        this.sky.material.uniforms.fKmESun.value = fKmESun;\n        this.sky.material.uniforms.fKrESun.value = fKrESun;\n    }\n\n    CelestialObject.prototype.g = function(val) {\n        if (!arguments.length) return this.atmosphere.g;\n\n        var val2 = val * val\n        this.atmosphere.g = val;\n        this.sky.material.uniforms.g.value = val;\n        this.sky.material.uniforms.g2.value = val2;\n        this.ground.material.uniforms.g.value = val;\n        this.ground.material.uniforms.g2.value = val2;\n    }\n\n    CelestialObject.prototype.Km = function(val) {\n        if (!arguments.length) return this.atmosphere.Km;\n\n        var fKmESun = CelestialObject.uniforms.calcfKmESun(val, this.atmosphere.ESun),\n            fKm4PI = CelestialObject.uniforms.calcfKm4PI(val);\n\n        this.atmosphere.Km = val;\n        this.ground.material.uniforms.fKmESun.value = fKmESun;\n        this.ground.material.uniforms.fKm4PI.value = fKm4PI;\n        this.sky.material.uniforms.fKm4PI.value = fKm4PI;\n        this.sky.material.uniforms.fKmESun.value = fKmESun;\n    }\n\n    CelestialObject.prototype.Kr = function(val) {\n        if (!arguments.length) return this.atmosphere.Kr;\n\n        var fKrESun = CelestialObject.uniforms.calcfKrESun(val, this.atmosphere.ESun),\n            fKr4PI = CelestialObject.uniforms.calcfKr4PI(val);\n\n        this.atmosphere.Kr = val;\n        this.ground.material.uniforms.fKrESun.value = fKrESun;\n        this.ground.material.uniforms.fKr4PI.value = fKr4PI;\n        this.sky.material.uniforms.fKr4PI.value = fKr4PI;\n        this.sky.material.uniforms.fKrESun.value = fKrESun;\n    }\n\n    CelestialObject.prototype.lightPosition = function(position) {\n        if (!arguments.length) return this.ground.material.uniforms.v3LightPosition.value;\n\n        this.ground.material.uniforms.v3LightPosition.value.copy(position).normalize();\n        this.sky.material.uniforms.v3LightPosition.value.copy(position).normalize();\n    };\n\n    CelestialObject.prototype.position = function(position) {\n        if (!arguments.length) return this.ground.position;\n\n        this.ground.position.copy(position);\n        this.sky.position.copy(position);\n    };\n\n    CelestialObject.prototype.setTextures = function(textures) {\n        if (textures.diffuse) {\n            this.ground.material.uniforms.tDiffuse.value = textures.diffuse;\n        }\n        if (textures.diffuseNight) {\n            this.ground.material.uniforms.tDiffuseNight.value = textures.diffuseNight;\n        }\n        if (textures.diffuseSpecular) {\n            this.ground.material.uniforms.tDiffuseSpecular.value = textures.diffuseSpecular;\n        }\n    };\n\n    CelestialObject.prototype.scaleDepth = function(val) {\n        if (!arguments.length) return this.atmosphere.scaleDepth;\n\n        var overScale = CelestialObject.uniforms.calcfScaleOverScaleDepth(this.atmosphere.innerRadius,\n                                                                          this.atmosphere.outerRadius,\n                                                                          this.atmosphere.scaleDepth);\n        this.atmosphere.scaleDepth = val;\n        this.ground.material.uniforms.fScaleDepth.value = val;\n        this.ground.material.uniforms.fScaleDepth.value = val;\n        this.sky.material.uniforms.fScaleOverScaleDepth.value = overScale;\n        this.sky.material.uniforms.fScaleOverScaleDepth.value = overScale;\n    }\n\n    CelestialObject.prototype.waveBlue = function(val) {\n        if (!arguments.length) return this.atmosphere.wavelength[2];\n\n        var blue = CelestialObject.uniforms.calcvWaveChannel(val);\n        this.atmosphere.wavelength[2] = val;\n        this.ground.material.uniforms.v3InvWavelength.value.setZ(blue);\n        this.sky.material.uniforms.v3InvWavelength.value.setZ(blue);\n    }\n\n    CelestialObject.prototype.waveGreen = function(val) {\n        if (!arguments.length) return this.atmosphere.wavelength[1];\n\n        var green = CelestialObject.uniforms.calcvWaveChannel(val);\n        this.atmosphere.wavelength[1] = val;\n        this.ground.material.uniforms.v3InvWavelength.value.setY(green);\n        this.sky.material.uniforms.v3InvWavelength.value.setY(green);\n    }\n\n    CelestialObject.prototype.waveRed = function(val) {\n        if (!arguments.length) return this.atmosphere.wavelength[0];\n\n        var red = CelestialObject.uniforms.calcvWaveChannel(val);\n        this.atmosphere.wavelength[0] = val;\n        this.ground.material.uniforms.v3InvWavelength.value.setX(red);\n        this.sky.material.uniforms.v3InvWavelength.value.setX(red);\n    }\n\n    return CelestialObject;\n\n})();\n","TRACKER.namespace('CelestialObject.uniforms');\n\nTRACKER.CelestialObject.uniforms = (function() {\n    'use strict';\n\n    return {\n        calcfKrESun: calcfKrESun,\n        calcfKmESun: calcfKmESun,\n        calcfKr4PI: calcfKr4PI,\n        calcfKm4PI: calcfKm4PI,\n        calcfScaleOverScaleDepth: calcfScaleOverScaleDepth,\n        calcvWaveChannel: calcvWaveChannel,\n        configureUniforms: configureUniforms\n    }\n\n    function calcfKrESun(Kr, ESun) {\n        return Kr * ESun\n    }\n\n    function calcfKmESun(Km, ESun) {\n        return Km * ESun\n    }\n\n    function calcfKr4PI(Kr) {\n        return Kr * 4 * Math.PI\n    }\n\n    function calcfKm4PI(Km) {\n        return Km * 4 * Math.PI\n    }\n\n    function calcfScaleOverScaleDepth(innerRadius, outerRadius, scaleDepth) {\n        return 1 / (outerRadius - innerRadius) / scaleDepth\n    }\n\n    function calcvWaveChannel(val) {\n        return 1 / Math.pow(val, 4)\n    }\n\n    function configureUniforms(diffuse, diffuseNight, diffuseSpecular, atmosphere) {\n        return {\n            v3LightPosition: {\n                type: \"v3\",\n                value: new THREE.Vector3(1e8, 0, 1e8).normalize()\n            },\n            v3InvWavelength: {\n                type: \"v3\",\n                value: new THREE.Vector3(calcvWaveChannel(atmosphere.wavelength[0]),\n                                         calcvWaveChannel(atmosphere.wavelength[1]),\n                                         calcvWaveChannel(atmosphere.wavelength[2]))\n            },\n            fCameraHeight: {\n                type: \"f\",\n                value: 0\n            },\n            fCameraHeight2: {\n                type: \"f\",\n                value: 0\n            },\n            fInnerRadius: {\n                type: \"f\",\n                value: atmosphere.innerRadius\n            },\n            fInnerRadius2: {\n                type: \"f\",\n                value: atmosphere.innerRadius * atmosphere.innerRadius\n            },\n            fOuterRadius: {\n                type: \"f\",\n                value: atmosphere.outerRadius\n            },\n            fOuterRadius2: {\n                type: \"f\",\n                value: atmosphere.outerRadius * atmosphere.outerRadius\n            },\n            fKrESun: {\n                type: \"f\",\n                value: calcfKrESun(atmosphere.Kr, atmosphere.ESun)\n            },\n            fKmESun: {\n                type: \"f\",\n                value: calcfKmESun(atmosphere.Km, atmosphere.ESun)\n            },\n            fKr4PI: {\n                type: \"f\",\n                value: calcfKr4PI(atmosphere.Kr)\n            },\n            fKm4PI: {\n                type: \"f\",\n                value: calcfKm4PI(atmosphere.Km)\n            },\n            fScale: {\n                type: \"f\",\n                value: 1 / (atmosphere.outerRadius - atmosphere.innerRadius)\n            },\n            fScaleDepth: {\n                type: \"f\",\n                value: atmosphere.scaleDepth\n            },\n            fScaleOverScaleDepth: {\n                type: \"f\",\n                value: calcfScaleOverScaleDepth(atmosphere.innerRadius, atmosphere.outerRadius, atmosphere.scaleDepth)\n            },\n            g: {\n                type: \"f\",\n                value: atmosphere.g\n            },\n            g2: {\n                type: \"f\",\n                value: atmosphere.g * atmosphere.g\n            },\n            tDiffuse: {\n                type: \"t\",\n                value: diffuse\n            },\n            tDiffuseNight: {\n                type: \"t\",\n                value: diffuseNight\n            },\n            tDiffuseSpecular: {\n                type: \"t\",\n                value: diffuseSpecular\n            },\n            fNightScale: {\n                type: \"f\",\n                value: 1\n            },\n            fSpecularScale: {\n                type: \"f\",\n                value: 1\n            },\n            fSpecularSize: {\n                type: \"f\",\n                value: 25\n            }\n        };\n    }\n})();\n","$(document).ready(function() {\n\t'use strict';\n\n\tvar loaders = TRACKER.utils.Loaders;\n\n\tvar width  = window.innerWidth,\n\t\theight = window.innerHeight;\n\n\tvar tle = {\n\t\telektro1: {\n\t\t\t\"line1\": \"1 37344U 11001A   16084.50580970  .00000000  00000-0  10000-3 0  9991\",\n\t\t\t\"line2\": \"2 37344   1.5394  79.7599 0005633 181.1213 179.7726  1.00271467 19002\"\n\t\t},\n\t\telektro2: {\n\t\t\t\"line1\": \"1 41105U 15074A   16084.53509896 -.00000132  00000-0  00000+0 0  9998\",\n\t\t\t\"line2\": \"2 41105   0.2604 277.8149 0001219 144.5680  30.4420  1.00273958  1058\"\n\t\t},\n\t\tiss: {\n\t\t\t\"line1\": \"1 25544U 98067A   16087.52161653  .00004158  00000-0  69668-4 0  9998\",\n\t\t\t\"line2\": \"2 25544  51.6430 105.3354 0002084   2.4544 144.7923 15.54266717992278\"\n\t\t}\n\t};\n\n\tvar scale = 63.71,\n\t\tnow = new Date();\n\n\tvar\tearth,\n\t\tmoon,\n\t\tsun,\n\t\tmilkyway,\n\t\telektro1,\n\t\telektro2;\n\n\tvar camera,\n\t\tscene,\n\t\trenderer,\n\t\tcontrols;\n\n\n\tinit();\n\n\n\tfunction init() {\n\t\tvar assets = {},\n\t\t\tearthRadius = 6371 / scale,\n\t\t\tmoonRadius = 1738.14 / scale,\n\t\t\tposition,\n\t\t\twebglEl = document.getElementById('scene');\n\n\t\tcamera = new THREE.PerspectiveCamera(20, width / height, 1, 1e10);\n\t\tcamera.up = new THREE.Vector3( 0, 1, 0 );\n\n\t\tscene = new THREE.Scene();\n\t\t// x: red, y: green, z: blue\n\t\tvar axisHelper = new THREE.AxisHelper( 1000 );\n\t\t// scene.add( axisHelper );\n\n\t\trenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true});\n\t\trenderer.setPixelRatio(window.devicePixelRatio || 1);\n\t\trenderer.setSize(width, height);\n\t\trenderer.setClearColor(0x000000, 1);\n\t\twebglEl.appendChild(renderer.domElement);\n\n\t\tcontrols = new THREE.TrackballControls(camera, document.getElementById('scene'));\n\t\tcontrols.minDistance = 300;\n\t\tcontrols.maxDistance = 1e10;\n\n\t\twindow.addEventListener( 'resize', onWindowResize, false );\n\n\t\tvar onLoad = function() {\n\t\t\tsun = new TRACKER.Sun([assets.lensflare0, assets.lensflare2, assets.lensflare3]);\n\t\t\tmilkyway = TRACKER.milkyway;\n\n\t\t\tearth = new TRACKER.CelestialObject({\n\t\t\t\tdiffuse: assets.earthDay,\n\t\t\t\tdiffuseNight: assets.earthNight,\n\t\t\t\tdiffuseSpecular: assets.earthSpecular\n\t\t\t});\n\n\t\t\tmoon = new TRACKER.CelestialObject({\n\t\t\t\tatmosphere: {\n\t\t\t\t\tESun: 10,\n\t\t\t\t\tinnerRadius: moonRadius,\n\t\t\t\t\touterRadius: moonRadius + 0.1,\n\t\t\t\t\twavelength: [0.55, 0.55, 0.55]\n\t\t\t\t},\n\t\t\t\tdiffuse: assets.moon,\n\t\t\t\tdiffuseNight: assets.moonNight,\n\t\t\t\tdiffuseSpecular: assets.moonSpecular\n\t\t\t});\n\n\t\t\tassets.elektro.scale.set(1e-3, 1e-3, 1e-3);\n\t\t\telektro1 = new TRACKER.Satellite(tle.elektro1, scale, assets.elektro.clone());\n\t\t    elektro2 = new TRACKER.Satellite(tle.elektro2, scale, assets.elektro.clone());\n\n\t\t\tposition = elektro1.propagate(now);\n\t\t\telektro2.propagate(now);\n\t\t\tcamera.position.copy(position).multiplyScalar(1.05);\n\n\t\t\tvar lightPosition = sun.propagate(now);\n\t\t\tearth.lightPosition(lightPosition);\n\n\t\t\tmoon.position(new THREE.Vector3(100, 4e5/scale, 200));\n\t\t\tmoon.lightPosition(lightPosition);\n\n\t\t\tscene.add(earth.ground);\n\t\t\tscene.add(earth.sky);\n\t\t\tscene.add(moon.ground);\n\t\t\tscene.add(moon.sky);\n\t\t\tscene.add(elektro1.object3d);\n\t\t\tscene.add(elektro2.object3d);\n\t\t\tscene.add(sun.lensFlare);\n\t\t\tscene.add(sun.light);\n\t\t\tscene.add(new THREE.AmbientLight(0x111111));\n\n\t\t\tanimate();\n\t\t};\n\n\t\t$.when(\n\t\t\tloaders.defferedTextureLoader(assets, 'earthDay', '/src/images/earth/diffuse-low.jpg'),\n\t\t\tloaders.defferedTextureLoader(assets, 'earthNight', '/src/images/earth/diffuse-night-low.jpg'),\n\t\t\tloaders.defferedTextureLoader(assets, 'earthSpecular', '/src/images/earth/diffuse-specular-low.png'),\n\t\t\tloaders.defferedTextureLoader(assets, 'lensflare0', '/src/images/lensflare/lensflare0.png'),\n\t\t\tloaders.defferedTextureLoader(assets, 'lensflare2', '/src/images/lensflare/lensflare2.png'),\n\t\t\tloaders.defferedTextureLoader(assets, 'lensflare3', '/src/images/lensflare/lensflare3.png'),\n\t\t\tloaders.defferedTextureLoader(assets, 'moon', '/src/images/moon/moon-low.jpg'),\n\t\t\tloaders.defferedTextureLoader(assets, 'moonNight', '/src/images/earth/default-night.jpg'),\n\t\t\tloaders.defferedTextureLoader(assets, 'moonSpecular', '/src/images/earth/default-specular.png'),\n\t\t\tloaders.defferedOBJLoader(assets, 'elektro', '/src/obj/elektro.obj')\n\t\t)\n\t\t.then(function() {\n\t\t\tonLoad();\n\t\t});\n\t}\n\n\n\tfunction animate() {\n        requestAnimationFrame( animate );\n\t    render();\n\t}\n\n\tfunction render() {\n\t\tcontrols.update();\n\n        var cameraHeight = camera.position.length(),\n\t\t\tcameraHeight2 = cameraHeight * cameraHeight;\n\n        earth.sky.material.uniforms.fCameraHeight.value = cameraHeight;\n        earth.sky.material.uniforms.fCameraHeight2.value = cameraHeight2;\n        earth.ground.material.uniforms.fCameraHeight.value = cameraHeight;\n        earth.ground.material.uniforms.fCameraHeight2.value = cameraHeight2;\n\n\t\tmoon.ground.material.uniforms.fCameraHeight.value = cameraHeight;\n        moon.ground.material.uniforms.fCameraHeight2.value = cameraHeight2;\n\t\tmoon.sky.material.uniforms.fCameraHeight.value = cameraHeight;\n        moon.sky.material.uniforms.fCameraHeight2.value = cameraHeight2;\n\n        return renderer.render(scene, camera);\n\t}\n\n    function onWindowResize() {\n        camera.aspect = window.innerWidth / window.innerHeight;\n        camera.updateProjectionMatrix();\n        renderer.setSize( window.innerWidth, window.innerHeight );\n    }\n\n});\n","'use strict';\n\n\nTRACKER.namespace('milkyway');\n\n\nTRACKER.milkyway = (function() {\n    var milkyway = new THREE.Mesh(\n        new THREE.SphereGeometry(1e4, 64, 64),\n        new THREE.MeshBasicMaterial({\n            map: THREE.ImageUtils.loadTexture('/src/images/milkyway/milkyway.jpg'),\n            side: THREE.BackSide,\n            opacity: 0.1\n        })\n    )\n\n    return \t{\n        milkyway: milkyway\n    }\n})();\n","TRACKER.namespace('Satellite');\n\nTRACKER.Satellite = (function() {\n    'use strict';\n\n    var Const = TRACKER.utils.Constants,\n        CoordConverter = TRACKER.utils.CoordinateConverter,\n        Satellite;\n\n    Satellite = function(tle, scale, object3d) {\n        this.axis = new THREE.Vector3(0, 1, 0);\n        this.object3d = object3d;\n        this.satrec = satellite.twoline2satrec(tle.line1, tle.line2);\n        this.scale = scale;\n    };\n\n    Satellite.prototype.setObj = function(obj) {\n        this.object3d = obj;\n    };\n\n    Satellite.prototype.position = function(date, gmst) {\n        var p = satellite.propagate(\n    \t\tthis.satrec,\n    \t\tdate.getUTCFullYear(),\n    \t\tdate.getUTCMonth() + 1, // Note, this function requires months in range 1-12.\n    \t\tdate.getUTCDate(),\n    \t\tdate.getUTCHours(),\n    \t\tdate.getUTCMinutes(),\n    \t\tdate.getUTCSeconds()\n    \t).position;\n\n        return new THREE.Vector3(p.x, p.z, -p.y)\n            .divideScalar(this.scale)\n            .applyAxisAngle(this.axis, CoordConverter.getTerrestrialAngle(date, gmst));\n    };\n\n    Satellite.prototype.propagate = function(date, gmst) {\n        var position = this.position(date, gmst);\n        this.object3d.position.copy(position);\n\n        return position;\n    }\n\n    return Satellite;\n\n})();\n","TRACKER.namespace('Sun');\n\nTRACKER.Sun = (function() {\n    'use strict';\n\n    var Const = TRACKER.utils.Constants,\n        CoordConverter = TRACKER.utils.CoordinateConverter,\n        DateConverter = TRACKER.utils.DateConverter;\n\n    function frac(f) {\n        return f % 1;\n    }\n\n    var Sun = function(textures, color) {\n        var flareColor = new THREE.Color( 0xffffff );\n\n        if (color) {\n            flareColor.setHSL( color.h, color.s, color.l + 0.5 );\n        }\n        else {\n            flareColor.setHSL( 0.55, 0.9, 0.5 + 0.5 );\n        }\n\n        this.light = new THREE.DirectionalLight( 0xffffff, 1 );\n        this.lensFlare = new THREE.LensFlare( textures[0], 350, 0.0, THREE.AdditiveBlending, flareColor );\n        this.lensFlare.add( textures[1], 512, 0.0, THREE.AdditiveBlending );\n        this.lensFlare.add( textures[2], 60, 0.6, THREE.AdditiveBlending );\n        this.lensFlare.add( textures[2], 70, 0.7, THREE.AdditiveBlending );\n        this.lensFlare.add( textures[2], 120, 0.9, THREE.AdditiveBlending );\n        this.lensFlare.add( textures[2], 70, 1.0, THREE.AdditiveBlending );\n        this.lensFlare.customUpdateCallback = lensFlareUpdateCallback;\n    };\n\n    function lensFlareUpdateCallback( object ) {\n\t\tvar f, fl = object.lensFlares.length;\n\t\tvar flare;\n\t\tvar vecX = -object.positionScreen.x * 2;\n\t\tvar vecY = -object.positionScreen.y * 2;\n\t\tfor( f = 0; f < fl; f++ ) {\n\t\t\tflare = object.lensFlares[ f ];\n\t\t\tflare.x = object.positionScreen.x + vecX * flare.distance;\n\t\t\tflare.y = object.positionScreen.y + vecY * flare.distance;\n\t\t\tflare.rotation = 0;\n\t\t}\n\t\tobject.lensFlares[ 2 ].y += 0.025;\n\t\tobject.lensFlares[ 3 ].rotation = object.positionScreen.x * 0.5 + THREE.Math.degToRad( 45 );\n\t}\n\n    Sun.prototype.sunEclipticPosition = function(date) {\n        var tdb = DateConverter.utcToTdb(date),\n            ts = (tdb - Const.MJD2000) / Const.JULIAN_C,\n            u3 = Const.PI2 * frac(0.993133 + 99.997361*ts);\n\n        var l = Const.PI2 * frac(0.7859453 + u3/Const.PI2 +\n                        (6893.0*Math.sin(u3) + 72.0*Math.sin(2*u3) + 6191.2 * ts) / 1296.0e3);\n        var b = 0;\n        var r = 1.0001398 + 1.0e-6 *\n                    ((-16707.37 + 42.04*ts) * Math.cos(u3) - 139.57*Math.cos(2*u3) +\n                      30.76*Math.cos(Const.PI2*frac(0.8274+1236.8531*ts)));\n\n        return {\n            lambda: l,\n            betta: b,\n            range: r * Const.AU\n        };\n    }\n\n    Sun.prototype.position = function(date) {\n        var tdb = DateConverter.utcToTdb(date),\n            eclPos = this.sunEclipticPosition(date),\n            equPos = CoordConverter.eclipSpherToEquCart(tdb, eclPos.lambda, eclPos.betta, eclPos.range);\n\n        return new THREE.Vector3(equPos.x, equPos.z, -equPos.y).divideScalar(63.71)\n            .applyAxisAngle(new THREE.Vector3(0,1,0), CoordConverter.getTerrestrialAngle(date));\n    }\n\n    Sun.prototype.propagate = function(date) {\n        var p = this.position(date);\n\n        this.lensFlare.position.copy(p);\n        this.light.position.copy(p);\n\n        return p;\n    }\n\n    return Sun;\n\n})();\n"],"sourceRoot":"/source/"}